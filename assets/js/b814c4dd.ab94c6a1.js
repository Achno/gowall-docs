"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[8303],{5991:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=o(4848),t=o(8453);const i={sidebar_position:2},s="Schemas",c={id:"ocr/schema",title:"Schemas",description:"Schemas are a way to store configs of a provider (even save them in your dotfiles) so you don't have to repeat yourself with a lot of cli flags.",source:"@site/docs/ocr/schema.md",sourceDirName:"ocr",slug:"/ocr/schema",permalink:"/gowall-docs/ocr/schema",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/gowall-docs/ocr/introduction"},next:{title:"Usage",permalink:"/gowall-docs/ocr/usage"}},a={},l=[{value:"Rate Limitting",id:"rate-limitting",level:2},{value:"Provider Configs",id:"provider-configs",level:2},{value:"Pipeline Configs",id:"pipeline-configs",level:2},{value:"Text correction",id:"text-correction",level:2},{value:"Provider specific Configs",id:"provider-specific-configs",level:2}];function d(e){const n={admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"schemas",children:"Schemas"})}),"\n",(0,r.jsx)(n.p,{children:"Schemas are a way to store configs of a provider (even save them in your dotfiles) so you don't have to repeat yourself with a lot of cli flags."}),"\n",(0,r.jsxs)(n.p,{children:["You can create a schema file in ",(0,r.jsx)(n.code,{children:"~/.config/gowall/schema.yml"})," and add your settings there."]}),"\n",(0,r.jsx)(n.p,{children:"The following schema replaces the following command :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gowall ocr img.png -p openrouter -m qwen/qwen2.5-vl-72b-instruct:free\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'schemas:\n\n  - name: "op-qwen"  # <-- the most simplistic schema just for an introduction to the concept\n    config:\n      ocr:\n        provider: "openrouter"\n        model: "qwen/qwen2.5-vl-72b-instruct:free"\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"CLI flags will always override schema.yml options."})}),"\n",(0,r.jsx)(n.h2,{id:"rate-limitting",children:"Rate Limitting"}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsx)(n.p,{children:"It is recommended to change the rate limits, to increase performance/reduce time taken for OCR depending on the tier of the provider you are using (free,paid, etc...)."}),(0,r.jsx)(n.p,{children:"Same goes for selfhosting increase the rate limits if your hardware can handle it."})]}),"\n",(0,r.jsxs)(n.p,{children:["You can specify 2 fields ",(0,r.jsx)(n.code,{children:"rps"})," (requests per second) and ",(0,r.jsx)(n.code,{children:"burst"})," (burst requests) to adjust the rate limiting."]}),"\n",(0,r.jsxs)(n.p,{children:["Following the token ",(0,r.jsx)(n.strong,{children:"bucket rate limiting algorithm"}),", explained simply with an example  ",(0,r.jsx)(n.code,{children:"rps=2"})," ",(0,r.jsx)(n.code,{children:"burst=4"})," , just imagine you have a bucket of tokens. The burst request number is the number of tokens the bucket has first, 1 token = 1 request. At first you send 4 requests since you start with 4 tokens and after that you generate tokens with a rate of 2 tokens per second and can only make 2 requests per second obviously."]}),"\n",(0,r.jsx)(n.p,{children:"Notice the burst at first? and the stable rps after that? Thats what the following flags control."}),"\n",(0,r.jsxs)(n.p,{children:["\u27a4 ",(0,r.jsx)(n.code,{children:"-r"})," is the requests per second flag.",(0,r.jsx)(n.br,{}),"\n","\u27a4 ",(0,r.jsx)(n.code,{children:"-b"})," is the burst requests flag."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'  - name: "op-qwen"\n    config:\n      ocr:\n        provider: "openrouter"\n        model: "x-ai/grok-4-fast:free"\n      rate_limit:\n        rps: 2\n        burst: 4\n'})}),"\n",(0,r.jsx)(n.h2,{id:"provider-configs",children:"Provider Configs"}),"\n",(0,r.jsx)(n.p,{children:"You can control the following settings for all providers:"}),"\n",(0,r.jsxs)(n.p,{children:["\u27a4 ",(0,r.jsx)(n.code,{children:"prompt"})," : Used to replace the default prompt gowall provides.",(0,r.jsx)(n.br,{}),"\n","\u27a4 ",(0,r.jsx)(n.code,{children:"append_prompt"})," : Used to append to the default prompt gowall provides.",(0,r.jsx)(n.br,{}),"\n","\u27a4 ",(0,r.jsx)(n.code,{children:"language"})," : Used to specify the language of the OCR ",(0,r.jsx)(n.strong,{children:"Be vary careful depending on the provider you use this changes accordinly"}),". For example for tesseract english is ",(0,r.jsx)(n.code,{children:"eng"})," but for docling using EasyOCR its ",(0,r.jsx)(n.code,{children:"en"}),", you have to search this by yourself.",(0,r.jsx)(n.br,{}),"\n","\u27a4 ",(0,r.jsx)(n.code,{children:"format"})," : Used to specify the format of the output either ",(0,r.jsx)(n.code,{children:"md"})," (markdown) or ",(0,r.jsx)(n.code,{children:"txt"})," (plain text)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'  - name: "op-qwen"\n    config:\n      ocr:\n        provider: "openrouter"\n        model: "qwen/qwen2.5-vl-72b-instruct:free"\n        prompt: "Your OCR Prompt here which replaces the default prompt"\n        append_prompt: "This is a prompt that is appended to the default prompt gowall provides"\n        language: "eng"\n        format: "md"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"pipeline-configs",children:"Pipeline Configs"}),"\n",(0,r.jsx)(n.p,{children:"You can also control the following settings :"}),"\n",(0,r.jsxs)(n.p,{children:["\u27a4 ",(0,r.jsx)(n.code,{children:"dpi"})," : Used when providers don't accept pdfs and gowall has to covert it to images. Higher dpi means bigger image size sharper text. Lower dpi smaller image size but fuzzier text. (Default is ",(0,r.jsx)(n.code,{children:"150"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["\u27a4 ",(0,r.jsx)(n.code,{children:"concurrency"})," : Used to control the concurrency of pre-processing and post-processing stages. (Default is ",(0,r.jsx)(n.code,{children:"5"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["\u27a4 ",(0,r.jsx)(n.code,{children:"ocr_concurrency"})," : Used to control the concurrency of the ocr stage. (Default is ",(0,r.jsx)(n.code,{children:"10"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'  - name: "op-qwen"\n    config:\n      ocr:\n        provider: "openrouter"\n        model: "qwen/qwen2.5-vl-72b-instruct:free"\n      pipeline:\n        dpi: 150\n        concurrency: 5\n        ocr_concurrency: 10\n'})}),"\n",(0,r.jsx)(n.h2,{id:"text-correction",children:"Text correction"}),"\n",(0,r.jsx)(n.p,{children:"This stage is not enabled by default."}),"\n",(0,r.jsxs)(n.p,{children:["A stage of the post-processing part. Usually paired with tesseract so the OCR happens very fast and an LLM corrects the ",(0,r.jsx)(n.strong,{children:"grammar mistakes"}),", ",(0,r.jsx)(n.strong,{children:"closes brackets"}),", ",(0,r.jsx)(n.strong,{children:"tries to format the output in markdown"})," by placing various markdown syntax where needed."]}),"\n",(0,r.jsx)(n.p,{children:"On the below example we are using tesseract for the OCR and an LLM from the openrouter provider for the text correction."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'  - name: "tes-llm"\n    config:\n      ocr:\n        provider: "tesseract"\n        model: "tesseract"\n      text_correction:\n        enabled: true\n        rate_limit:  # <-- rate limits the post-processing provider not the ocr provider\n            rps: 2\n            burst: 4\n        provider:\n          provider: "openrouter"  # You can specify all the provider configs as seen in the \'Provider Configs\' section\n          model: "x-ai/grok-4-fast:free"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"provider-specific-configs",children:"Provider specific Configs"}),"\n",(0,r.jsx)(n.p,{children:"Providers may have specific configs that are unique to them unlike all the options above. If a provider has a specific config you will find it under its specific provider section in the documentation."}),"\n",(0,r.jsx)(n.p,{children:"The example above displays the options for Docling (both the docling CLI and the docling API service )"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="~/.config/gowall/schema.yml"',children:'  - name: "docling-cli"\n    config:\n      ocr:\n        provider: "docling"\n        model: "easyocr"\n        language: "en"\n      docling_options:\n        do_ocr: true\n        force_ocr: true\n        pipeline: "vlm"\n        pdf_backend: "..."\n        abort_on_error: true\n        document_timeout: "..."\n        num_threads: 3\n        device: "..."\n        verbose: "..."\n      \n'})}),"\n",(0,r.jsx)(n.p,{children:"All the options are from the docling CLI, they are also mostly named the same, so you would need to refer to the docs fo the provider."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Part of the docling cli --help\n\n\u2502 --pipeline      [standard|vlm|asr]                                         Choose the pipeline to process PDF or image files.                             \u2502\n\u2502 --vlm-model     [smoldocling|granite_vision|granite_vision_ollama]         Choose the VLM model to use with PDF or image files.                           \u2502\n\u2502                                                                             [default: smoldocling]                                                        \u2502\n\u2502 --ocr                                                                      If enabled, the bitmap content will be processed using OCR                     \u2502\n\u2502                                                                             [default: ocr]                                                                \u2502\n\u2502 --force-ocr                                                                Replace any existing text with OCR generated text over the full content        \u2502\n\u2502 --pdf-backend   [pypdfium2|dlparse_v1|dlparse_v2|dlparse_v4]               The PDF backend to use. [default: dlparse_v2]                                  \u2502\n\u2502 --abort-on-error                                                           If enabled, the processing will be aborted when the first error is encountered \u2502\n\u2502 --verbose             INTEGER                                              Set the verbosity level. -v for info logging, -vv for                          \u2502\n\u2502 --document-timeout    FLOAT                                                The timeout for processing each document, in seconds.                          \u2502\n\u2502 --num-threads         INTEGE                                               Number of threads [default: 4]                                                 \u2502\n\u2502 --device              [auto|cpu|cuda|mps]                                  Accelerator device [default: auto]                                             \u2502\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>c});var r=o(6540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);