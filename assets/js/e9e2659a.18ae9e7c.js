"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[8469],{8207:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var r=o(4848),t=o(8453);const s={title:"Fedora COPR & gowall",description:"The best guide on Fedora COPR",slug:"Fedora-COPR-gowall",authors:[{name:"Achno",title:"I'm just a silly little guy who likes Go, Image processing and Computer Vision",url:"https://github.com/Achno",image_url:"https://avatars.githubusercontent.com/u/129212519?s=400&v=4",socials:{github:"https://github.com/Achno"}}],tags:["go","Fedora-COPR","docker"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},i=void 0,l={permalink:"/gowall-docs/blog/Fedora-COPR-gowall",source:"@site/blog/2025-05-14-get-your-project-to-COPR.md",title:"Fedora COPR & gowall",description:"The best guide on Fedora COPR",date:"2025-05-14T00:00:00.000Z",tags:[{inline:!0,label:"go",permalink:"/gowall-docs/blog/tags/go"},{inline:!0,label:"Fedora-COPR",permalink:"/gowall-docs/blog/tags/fedora-copr"},{inline:!0,label:"docker",permalink:"/gowall-docs/blog/tags/docker"}],readingTime:5.485,hasTruncateMarker:!0,authors:[{name:"Achno",title:"I'm just a silly little guy who likes Go, Image processing and Computer Vision",url:"https://github.com/Achno",image_url:"https://avatars.githubusercontent.com/u/129212519?s=400&v=4",socials:{github:"https://github.com/Achno"},imageURL:"https://avatars.githubusercontent.com/u/129212519?s=400&v=4",key:null,page:null}],frontMatter:{title:"Fedora COPR & gowall",description:"The best guide on Fedora COPR",slug:"Fedora-COPR-gowall",authors:[{name:"Achno",title:"I'm just a silly little guy who likes Go, Image processing and Computer Vision",url:"https://github.com/Achno",image_url:"https://avatars.githubusercontent.com/u/129212519?s=400&v=4",socials:{github:"https://github.com/Achno"},imageURL:"https://avatars.githubusercontent.com/u/129212519?s=400&v=4"}],tags:["go","Fedora-COPR","docker"],image:"https://i.imgur.com/mErPwqL.png",hide_table_of_contents:!1},unlisted:!1},a={authorsImageUrls:[void 0]},c=[{value:"Before we start",id:"before-we-start",level:2},{value:"TLDR",id:"tldr",level:2},{value:"Getting Started : Environment &amp; .spec file",id:"getting-started--environment--spec-file",level:2},{value:"Build the RPM",id:"build-the-rpm",level:2},{value:"Test the RPM locally in the Docker container",id:"test-the-rpm-locally-in-the-docker-container",level:6},{value:"Upload your RPM to Fedora COPR",id:"upload-your-rpm-to-fedora-copr",level:2},{value:"Create a Fedora account",id:"create-a-fedora-account",level:6},{value:"Create a New Project &amp; Upload it",id:"create-a-new-project--upload-it",level:6},{value:"How Users will download your package",id:"how-users-will-download-your-package",level:2},{value:"Automate all of this with Github actions",id:"automate-all-of-this-with-github-actions",level:2},{value:"How to get your package to the official Fedora repositories",id:"how-to-get-your-package-to-the-official-fedora-repositories",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h6:"h6",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["The best guide where i hold your hand from 0-100 to get your project on Fedora COPR.\nWork within docker and learn how ",(0,r.jsx)(n.a,{href:"../docs/intro",children:"gowall"})," was put on Fedora COPR."]}),"\n",(0,r.jsx)(n.h2,{id:"before-we-start",children:"Before we start"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"I) When i was trying to put my project on Fedora COPR, i struggled quite a bit because the documentation was, well... nonexistent ."}),"\n",(0,r.jsx)(n.p,{children:"II) What didn't help was that i had zero idea how to even make a Linux RPM package (probably like your dear reader)."}),"\n",(0,r.jsx)(n.p,{children:"III) Even worse i have never played around with Fedora before."}),"\n",(0,r.jsxs)(n.p,{children:["To address ",(0,r.jsx)(n.code,{children:"I)"})," & ",(0,r.jsx)(n.code,{children:"II"})," i will make sure to hold your hand throughout this article from 0 to 100 and explain things as best as i can. To address problem ",(0,r.jsx)(n.code,{children:"III)"})," we will use ",(0,r.jsx)(n.code,{children:"docker"})," to build the project since Fedora is not my daily driver and this allows everyone to participate with a clean environment no matter their distro from the same starting point."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prerequisites"})," : ",(0,r.jsx)(n.code,{children:"Docker"})]}),"\n",(0,r.jsxs)(n.p,{children:["If you are on Fedora and you don't want to use ",(0,r.jsx)(n.code,{children:"Docker"})," that's fine as well.\nLastly this guide was created from my notes in Obsidian so there may be some inconsistencies."]}),"\n",(0,r.jsx)(n.h2,{id:"tldr",children:"TLDR"}),"\n",(0,r.jsxs)(n.p,{children:["You grab your project from your ",(0,r.jsx)(n.code,{children:"tarballs"})," (ex. github release section),write a ",(0,r.jsx)(n.code,{children:".spec"})," file, build the ",(0,r.jsx)(n.code,{children:".rpm"}),", test its working as expected with ",(0,r.jsx)(n.code,{children:"dnf"})," and then you just push your project to the COPR repositories via the ",(0,r.jsx)(n.code,{children:"copr-cli"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"getting-started--environment--spec-file",children:"Getting Started : Environment & .spec file"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Run Fedora in docker so we can  build the ",(0,r.jsx)(n.code,{children:".rpm"})," there and test that its working."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Here i also install ",(0,r.jsx)(n.code,{children:"go"})," since you know gowall is writen in ",(0,r.jsx)(n.code,{children:"go"})," ... ",(0,r.jsx)(n.code,{children:"go-wall"}),", yea anyway"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker run -it fedora:latest\nsudo dnf update -y\nsudo dnf install rpm-build rpmdevtools git dnf-plugins-core golang -y\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Set up the RPM build directory"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Some tools expect you to be running as not-root so we have to create a user. This builder user is a pleb for now. We will give him sudo permissions later."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"useradd -m builder\nsu - builder\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"rpmdev-setuptree\n"})}),"\n",(0,r.jsx)(n.p,{children:"The directory structure should look something like this :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"rpmbuild/\n\u251c\u2500\u2500 BUILD\n\u251c\u2500\u2500 RPMS\n\u251c\u2500\u2500 SOURCES\n\u251c\u2500\u2500 SPECS\n\u251c\u2500\u2500 SRPMS\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["Put your tarball ",(0,r.jsx)(n.code,{children:"tar.gz"})," (ex. from github releases) within the ",(0,r.jsx)(n.code,{children:"SOURCES"})," folder"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/rpmbuild/SOURCES\n\ncurl -L -o gowall-0.2.0.tar.gz \nhttps://github.com/Achno/gowall/archive/refs/tags/v0.2.0.tar.gz\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Navigate to the ",(0,r.jsx)(n.code,{children:"SPECS"})," directory,Create a spec file for your project, if you happen to be building a ",(0,r.jsx)(n.code,{children:"go"})," project like me you can easily copy-paste the below ",(0,r.jsx)(n.code,{children:".spec"})," provided your project does not depend on other packages."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd ~/rpmbuild/SPECS\ntouch gowall.spec\nvi gowall.spec\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You could also try the ",(0,r.jsx)(n.code,{children:"rpmdev-newspec"})," utility if you want for the ",(0,r.jsx)(n.code,{children:".spec"})," file. Check ",(0,r.jsx)(n.a,{href:"https://rpm-packaging-guide.github.io/#working-with-spec-files",children:"this"})," resource if you want to understand what all these fields mean."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title:"gowall.spec"',children:'Name:           gowall\nVersion:        0.2.1\nRelease:        1%{?dist}\nSummary:        An image processing toolbox CLI, Convert wallpapers color theme...\n\nLicense:        MIT\nURL:            https://github.com/Achno/gowall\nSource0:        %{name}-%{version}.tar.gz\n\nBuildRequires:  golang\nBuildRequires: git\nRequires:       glibc\n\n%description\n%{summary}\n\n%prep\n%setup -q\n\n%build\nexport CGO_CPPFLAGS="${CPPFLAGS}"\nexport CGO_CFLAGS="${CFLAGS}"\nexport CGO_CXXFLAGS="${CXXFLAGS}"\nexport CGO_LDFLAGS="${LDFLAGS}"\nexport GOFLAGS="-buildmode=pie -trimpath -ldflags=-linkmode=external -mod=readonly -modcacherw"\n\ngo mod tidy\ngo build -v -o gowall\n\n%install\ninstall -Dm0755 %{name} %{buildroot}%{_bindir}/%{name}\n\n%files\n%{_bindir}/%{name}\n%license LICENSE\n%doc README.md\n\n'})}),"\n",(0,r.jsx)(n.h2,{id:"build-the-rpm",children:"Build the RPM"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Build the package, you should see a ",(0,r.jsx)(n.code,{children:".rpm"})," and a ",(0,r.jsx)(n.code,{children:"SRPM"})," ",(0,r.jsx)(n.code,{children:"src.rpm"}),". For example"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"rpmbuild -ba gowall.spec\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["RPM: ",(0,r.jsx)(n.code,{children:"~/rpmbuild/RPMS/x86_64/PackageName-0.1.9-1.fc38.x86_64.rpm"})]}),"\n",(0,r.jsxs)(n.li,{children:["SRPM: ",(0,r.jsx)(n.code,{children:"~/rpmbuild/SRPMS/PackageName-0.1.9-1.src.rpm"})]}),"\n"]}),"\n",(0,r.jsx)(n.h6,{id:"test-the-rpm-locally-in-the-docker-container",children:"Test the RPM locally in the Docker container"}),"\n",(0,r.jsxs)(n.p,{children:["Type ",(0,r.jsx)(n.code,{children:"exit"})," to go back to the root user and make the builder have sudo permissions ",(0,r.jsx)(n.code,{children:"usermod -aG wheel builder"})," and change his password ",(0,r.jsx)(n.code,{children:"passwd builder"})," and lastly change back to the builder user ",(0,r.jsx)(n.code,{children:"su - builder"}),". Now we can test our package"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo dnf install ~/rpmbuild/RPMS/x86_64/gowall-0.2.0-1.fc$(rpm -E %fedora).x86_64.rpm\n"})}),"\n",(0,r.jsx)(n.p,{children:"Now lets test our application. You will see the gowall version if you run it and that confirms that its working just fine."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"gowall -v \n"})}),"\n",(0,r.jsx)(n.p,{children:"Then just remove it with the following, after you are done testing it :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo dnf remove gowall\n"})}),"\n",(0,r.jsx)(n.h2,{id:"upload-your-rpm-to-fedora-copr",children:"Upload your RPM to Fedora COPR"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h6,{id:"create-a-fedora-account",children:"Create a Fedora account"}),"\n",(0,r.jsxs)(n.p,{children:["Visit ",(0,r.jsx)(n.a,{href:"https://copr.fedorainfracloud.org/",children:"here"})," and sign up. Then visit the fedora COPR website and login,once logged in, scroll down to the page footer. You will see ",(0,r.jsx)(n.code,{children:"Site navigation"})," and ",(0,r.jsx)(n.code,{children:"API"})," on the center. You will then see a code block with some configuration ",(0,r.jsx)(n.strong,{children:"copy"})," that."]}),"\n",(0,r.jsxs)(n.p,{children:["Next install ",(0,r.jsx)(n.code,{children:"copr-cli"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo dnf install copr-cli\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create the below file and ",(0,r.jsx)(n.strong,{children:"paste"})," that configuration there. The config is just an auth token so we can push our project to the COPR servers."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"vi ~/.config/copr\n"})}),"\n",(0,r.jsx)(n.h6,{id:"create-a-new-project--upload-it",children:"Create a New Project & Upload it"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a new project"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"--chroot"})," is important and are the architectures you want to build for as well as the fedora versions. If Fedora upgrades you also need to update your COPR package as well."]}),"\n",(0,r.jsx)(n.p,{children:"Everything can be changed BUT the package name so be careful."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'copr-cli create gowall --chroot fedora-41-x86_64 --description "A tool to convert a Wallpaper\'s color scheme & more image processing features"\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Create the ",(0,r.jsx)(n.code,{children:".src.rpm"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"rpmbuild -bs ~/rpmbuild/SPECS/gowall.spec\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"You need to enable internet access during builds.\nGo to the fedora COPR website and then check that checkbox :  Settings>Enable Internet Access during builds."})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["Upload the  ",(0,r.jsx)(n.code,{children:".src.rpm"})," to COPR. Now we uploaded a build"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"copr-cli build gowall ~/rpmbuild/SRPMS/gowall-0.2.0-1.fc41.src.rpm\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Go to the COPR dashboard and monitor the build status and enjoy the fruit of your labor."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-users-will-download-your-package",children:"How Users will download your package"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Installation is incredibly easy. Enable the repository and install the package."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo dnf copr enable <your_fedora_username>/<PackageName>\nsudo dnf install <PackageName>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can see your username in the ",(0,r.jsx)(n.code,{children:"~/.config/copr"})," file we created earlier."]}),"\n",(0,r.jsx)(n.p,{children:"Now in the COPR package section head over to setting and fill in the Instructions on how your project can be installed"}),"\n",(0,r.jsx)(n.h2,{id:"automate-all-of-this-with-github-actions",children:"Automate all of this with Github actions"}),"\n",(0,r.jsxs)(n.p,{children:["Check ",(0,r.jsx)(n.a,{href:"https://docs.pagure.org/copr.copr/user_documentation.html#triggerring-builds-by-tag-events",children:"here"})," on how to automate all of this by triggering builds on push by tag events on a CI pipeline"]}),"\n",(0,r.jsx)(n.h2,{id:"how-to-get-your-package-to-the-official-fedora-repositories",children:"How to get your package to the official Fedora repositories"}),"\n",(0,r.jsxs)(n.p,{children:["It's a really back and forth time consuming process, this ",(0,r.jsx)(n.a,{href:"https://www.youtube.com/watch?app=desktop&v=w3e3W00KqVI",children:"video"})," is the best i have seen in explaining it."]}),"\n",(0,r.jsxs)(n.p,{children:["I hope you liked my style of writing :) Check out ",(0,r.jsx)(n.a,{href:"https://github.com/Achno/gowall",children:"gowall"})," if like you like features like converting wallpapers or icons to your favourite color scheme, OCR powered via Local Vision LLM's Tesseract + LLM's along with other providers ( scheduled for the ",(0,r.jsx)(n.strong,{children:"v0.2.2"})," release, well whenever i release that) and other image processing features."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>l});var r=o(6540);const t={},s=r.createContext(t);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);