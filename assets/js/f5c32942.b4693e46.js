"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[2407],{2616:e=>{e.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"Fedora-COPR-gowall","metadata":{"permalink":"/gowall-docs/blog/Fedora-COPR-gowall","source":"@site/blog/2025-05-14-get-your-project-to-COPR.md","title":"Fedora COPR & gowall","description":"The best guide on Fedora COPR","date":"2025-05-14T00:00:00.000Z","tags":[{"inline":true,"label":"go","permalink":"/gowall-docs/blog/tags/go"},{"inline":true,"label":"Fedora-COPR","permalink":"/gowall-docs/blog/tags/fedora-copr"},{"inline":true,"label":"docker","permalink":"/gowall-docs/blog/tags/docker"}],"readingTime":5.485,"hasTruncateMarker":true,"authors":[{"name":"Achno","title":"I\'m just a silly little guy who likes Go, Image processing and Computer Vision","url":"https://github.com/Achno","image_url":"https://avatars.githubusercontent.com/u/129212519?s=400&v=4","socials":{"github":"https://github.com/Achno"},"imageURL":"https://avatars.githubusercontent.com/u/129212519?s=400&v=4","key":null,"page":null}],"frontMatter":{"title":"Fedora COPR & gowall","description":"The best guide on Fedora COPR","slug":"Fedora-COPR-gowall","authors":[{"name":"Achno","title":"I\'m just a silly little guy who likes Go, Image processing and Computer Vision","url":"https://github.com/Achno","image_url":"https://avatars.githubusercontent.com/u/129212519?s=400&v=4","socials":{"github":"https://github.com/Achno"},"imageURL":"https://avatars.githubusercontent.com/u/129212519?s=400&v=4"}],"tags":["go","Fedora-COPR","docker"],"image":"https://i.imgur.com/mErPwqL.png","hide_table_of_contents":false},"unlisted":false},"content":"The best guide where i hold your hand from 0-100 to get your project on Fedora COPR.\\nWork within docker and learn how [gowall](../docs/intro) was put on Fedora COPR.\\n\\n\x3c!-- truncate --\x3e\\n\\n## Before we start\\n---\\n\\nI) When i was trying to put my project on Fedora COPR, i struggled quite a bit because the documentation was, well... nonexistent . \\n\\nII) What didn\'t help was that i had zero idea how to even make a Linux RPM package (probably like your dear reader).\\n\\nIII) Even worse i have never played around with Fedora before.\\n\\nTo address `I)` & `II` i will make sure to hold your hand throughout this article from 0 to 100 and explain things as best as i can. To address problem `III)` we will use `docker` to build the project since Fedora is not my daily driver and this allows everyone to participate with a clean environment no matter their distro from the same starting point.\\n\\n**Prerequisites** : `Docker`\\n\\nIf you are on Fedora and you don\'t want to use `Docker` that\'s fine as well.\\nLastly this guide was created from my notes in Obsidian so there may be some inconsistencies.\\n\\n## TLDR\\n\\nYou grab your project from your `tarballs` (ex. github release section),write a `.spec` file, build the `.rpm`, test its working as expected with `dnf` and then you just push your project to the COPR repositories via the `copr-cli`.\\n\\n\\n## Getting Started : Environment & .spec file\\n---\\n\\n1. Run Fedora in docker so we can  build the `.rpm` there and test that its working.\\n\\nHere i also install `go` since you know gowall is writen in `go` ... `go-wall`, yea anyway\\n```bash\\ndocker run -it fedora:latest\\nsudo dnf update -y\\nsudo dnf install rpm-build rpmdevtools git dnf-plugins-core golang -y\\n```\\n\\n2. Set up the RPM build directory\\n\\nSome tools expect you to be running as not-root so we have to create a user. This builder user is a pleb for now. We will give him sudo permissions later.\\n\\n```\\nuseradd -m builder\\nsu - builder\\n```\\n\\n```bash\\nrpmdev-setuptree\\n```\\n\\nThe directory structure should look something like this : \\n\\n```\\nrpmbuild/\\n\u251c\u2500\u2500 BUILD\\n\u251c\u2500\u2500 RPMS\\n\u251c\u2500\u2500 SOURCES\\n\u251c\u2500\u2500 SPECS\\n\u251c\u2500\u2500 SRPMS\\n```\\n\\n3. Put your tarball `tar.gz` (ex. from github releases) within the `SOURCES` folder\\n\\n```bash\\ncd ~/rpmbuild/SOURCES\\n\\ncurl -L -o gowall-0.2.0.tar.gz \\nhttps://github.com/Achno/gowall/archive/refs/tags/v0.2.0.tar.gz\\n```\\n\\n4. Navigate to the `SPECS` directory,Create a spec file for your project, if you happen to be building a `go` project like me you can easily copy-paste the below `.spec` provided your project does not depend on other packages.\\n\\n```bash\\ncd ~/rpmbuild/SPECS\\ntouch gowall.spec\\nvi gowall.spec\\n```\\n\\nYou could also try the `rpmdev-newspec` utility if you want for the `.spec` file. Check [this](https://rpm-packaging-guide.github.io/#working-with-spec-files) resource if you want to understand what all these fields mean.\\n\\n```bash title:\\"gowall.spec\\"\\nName:           gowall\\nVersion:        0.2.1\\nRelease:        1%{?dist}\\nSummary:        An image processing toolbox CLI, Convert wallpapers color theme...\\n\\nLicense:        MIT\\nURL:            https://github.com/Achno/gowall\\nSource0:        %{name}-%{version}.tar.gz\\n\\nBuildRequires:  golang\\nBuildRequires: git\\nRequires:       glibc\\n\\n%description\\n%{summary}\\n\\n%prep\\n%setup -q\\n\\n%build\\nexport CGO_CPPFLAGS=\\"${CPPFLAGS}\\"\\nexport CGO_CFLAGS=\\"${CFLAGS}\\"\\nexport CGO_CXXFLAGS=\\"${CXXFLAGS}\\"\\nexport CGO_LDFLAGS=\\"${LDFLAGS}\\"\\nexport GOFLAGS=\\"-buildmode=pie -trimpath -ldflags=-linkmode=external -mod=readonly -modcacherw\\"\\n\\ngo mod tidy\\ngo build -v -o gowall\\n\\n%install\\ninstall -Dm0755 %{name} %{buildroot}%{_bindir}/%{name}\\n\\n%files\\n%{_bindir}/%{name}\\n%license LICENSE\\n%doc README.md\\n\\n```\\n\\n\\n## Build the RPM \\n---\\n\\n1. Build the package, you should see a `.rpm` and a `SRPM` `src.rpm`. For example\\n\\n```bash\\nrpmbuild -ba gowall.spec\\n```\\n\\n- RPM: `~/rpmbuild/RPMS/x86_64/PackageName-0.1.9-1.fc38.x86_64.rpm`\\n- SRPM: `~/rpmbuild/SRPMS/PackageName-0.1.9-1.src.rpm`\\n\\n###### Test the RPM locally in the Docker container\\n\\nType `exit` to go back to the root user and make the builder have sudo permissions `usermod -aG wheel builder` and change his password `passwd builder` and lastly change back to the builder user `su - builder`. Now we can test our package\\n\\n```bash\\nsudo dnf install ~/rpmbuild/RPMS/x86_64/gowall-0.2.0-1.fc$(rpm -E %fedora).x86_64.rpm\\n```\\n\\nNow lets test our application. You will see the gowall version if you run it and that confirms that its working just fine.\\n```\\ngowall -v \\n```\\n\\nThen just remove it with the following, after you are done testing it : \\n\\n```bash\\nsudo dnf remove gowall\\n```\\n\\n\\n## Upload your RPM to Fedora COPR\\n---\\n\\n###### Create a Fedora account \\n\\n Visit [here](https://copr.fedorainfracloud.org/) and sign up. Then visit the fedora COPR website and login,once logged in, scroll down to the page footer. You will see `Site navigation` and `API` on the center. You will then see a code block with some configuration **copy** that.\\n\\nNext install `copr-cli`.\\n\\n```bash\\nsudo dnf install copr-cli\\n```\\n\\n- Create the below file and **paste** that configuration there. The config is just an auth token so we can push our project to the COPR servers.\\n\\n```bash\\nvi ~/.config/copr\\n```\\n\\n\\n###### Create a New Project & Upload it\\n\\n1. Create a new project\\n\\nThe `--chroot` is important and are the architectures you want to build for as well as the fedora versions. If Fedora upgrades you also need to update your COPR package as well.\\n\\nEverything can be changed BUT the package name so be careful.\\n```bash\\ncopr-cli create gowall --chroot fedora-41-x86_64 --description \\"A tool to convert a Wallpaper\'s color scheme & more image processing features\\"\\n```\\n\\n\\n2. Create the `.src.rpm` \\n\\n```bash\\nrpmbuild -bs ~/rpmbuild/SPECS/gowall.spec\\n```\\n\\n:::warning\\n\\nYou need to enable internet access during builds. \\nGo to the fedora COPR website and then check that checkbox :  Settings>Enable Internet Access during builds.\\n\\n:::\\n\\n3. Upload the  `.src.rpm` to COPR. Now we uploaded a build\\n\\n```bash\\ncopr-cli build gowall ~/rpmbuild/SRPMS/gowall-0.2.0-1.fc41.src.rpm\\n```\\n\\n\\n4. Go to the COPR dashboard and monitor the build status and enjoy the fruit of your labor.\\n\\n\\n## How Users will download your package\\n---\\n\\nInstallation is incredibly easy. Enable the repository and install the package.\\n\\n```bash\\nsudo dnf copr enable <your_fedora_username>/<PackageName>\\nsudo dnf install <PackageName>\\n```\\n\\nYou can see your username in the `~/.config/copr` file we created earlier.\\n\\nNow in the COPR package section head over to setting and fill in the Instructions on how your project can be installed\\n\\n## Automate all of this with Github actions\\n\\nCheck [here](https://docs.pagure.org/copr.copr/user_documentation.html#triggerring-builds-by-tag-events) on how to automate all of this by triggering builds on push by tag events on a CI pipeline\\n\\n## How to get your package to the official Fedora repositories\\n\\nIt\'s a really back and forth time consuming process, this [video](https://www.youtube.com/watch?app=desktop&v=w3e3W00KqVI) is the best i have seen in explaining it.\\n\\nI hope you liked my style of writing :) Check out [gowall](https://github.com/Achno/gowall) if like you like features like converting wallpapers or icons to your favourite color scheme, OCR powered via Local Vision LLM\'s Tesseract + LLM\'s along with other providers ( scheduled for the **v0.2.2** release, well whenever i release that) and other image processing features."}]}}')}}]);